import{j as e,r as l,a as k}from"./react-BrP7bTIu.js";import{c as A}from"./react-dom-BtizlmEl.js";import{i as R,g as q,a as I,b as P,q as B,w as O,c as D,d as z,o as H,s as W,e as F,f as K,u as Z,h as Y,j as G,k as N,l as C,m as J}from"./@firebase-DLhgF3GW.js";import"./firebase-BGoxOC5i.js";import{d as w,e as V,f as X,g as j}from"./react-router-C0nYgrbg.js";import{N as E,H as Q}from"./react-router-dom-iW47g7mf.js";import"./scheduler-CzFDRTuY.js";import"./tslib-BGVaTf34.js";import"./idb-BXWtuYvb.js";import"./@remix-run-BgBg4VcQ.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))c(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&c(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();const ee="_container_11yjs_2",se={container:ee},te="_container_ashy1_1",re={container:te},ae="_container_12177_1",ne="_time_12177_12",L={container:ae,time:ne},g=({messageText:a,time:t})=>e.jsxs("div",{className:L.container,children:[e.jsx("span",{children:a}),e.jsx("span",{className:L.time,children:t})]}),oe="_container_6gyfo_1",ce={container:oe},ie=()=>e.jsx("div",{className:ce.container,children:e.jsx("textarea",{})}),le=()=>e.jsxs("div",{className:re.container,children:[e.jsx(g,{messageText:"111111111111111111111111",time:"15:40"}),e.jsx(g,{messageText:"22222222222222222222",time:"15:40"}),e.jsx(g,{messageText:"333333333333333333333333333333333",time:"15:40"}),e.jsx(g,{messageText:"444444444444444444",time:"15:40"}),e.jsx(g,{messageText:"55555555555555555555555555",time:"15:40"}),e.jsx(ie,{})]}),ue="_container_140fh_1",de="_wrapper_140fh_10",pe="_username_140fh_13",me="_message_140fh_16",h={container:ue,wrapper:de,username:pe,message:me},p=({username:a,img:t,lastMessage:n})=>e.jsxs("div",{className:h.container,children:[e.jsx("img",{src:t}),e.jsxs("div",{className:h.wrapper,children:[e.jsx("p",{className:h.username,children:a}),e.jsx("p",{className:h.message,children:n})]})]}),ge="_container_13318_1",he={container:ge},xe={apiKey:"AIzaSyAB80-tZTx63iK-eSokF2n1HNM25fO_rZ4",authDomain:"react-chat-app-cf377.firebaseapp.com",projectId:"react-chat-app-cf377",storageBucket:"react-chat-app-cf377.appspot.com",messagingSenderId:"333727045415",appId:"1:333727045415:web:07aac7a056b70e402bbb02"};R(xe);const x=q(),je=I(),y=P(),fe=({setSearchedUser:a})=>{const[t,n]=l.useState(""),c=async s=>{console.log(s);const r=B(D(y,"users"),O("email","==",s));try{(await z(r)).forEach(i=>{console.log(i.data());const m=i.data();a({username:m.displayName,img:m.photoURL,lastMessage:"???"})})}catch(o){n(String(o)),console.log(o)}};return e.jsxs("div",{className:he.container,children:[e.jsx("input",{type:"text",placeholder:"Search email",onChange:s=>{c(s.target.value)}}),t!==""&&e.jsx("p",{children:t})]})},_e="_container_yqqb2_1",ye="_navbar_yqqb2_5",we="_logoutBtn_yqqb2_11",f={container:_e,navbar:ye,logoutBtn:we},v=l.createContext({currentUser:{},isLoading:!0}),ve=({children:a})=>{const[t,n]=l.useState({}),[c,s]=l.useState(!0);return l.useEffect(()=>{const r=H(x,o=>{o&&n(o),s(!1)});return()=>{r()}},[t]),e.jsx(v.Provider,{value:{currentUser:t,isLoading:c},children:a})},be=()=>{const a=w(),{currentUser:t}=l.useContext(v),[n,c]=l.useState({username:"",img:"",lastMessage:""});return e.jsxs("div",{className:f.container,children:[e.jsxs("div",{className:f.navbar,children:[e.jsx("img",{src:t==null?void 0:t.photoURL,alt:t.displayName}),e.jsx("span",{children:t.displayName}),e.jsx("button",{className:f.logoutBtn,onClick:()=>{W(x).then(()=>{console.log("WYLogoWANO"),a("../login",{replace:!0})}).catch(s=>{console.log(s)})},children:"Logout"})]}),e.jsx(fe,{setSearchedUser:c}),n.username!==""&&e.jsx(p,{username:n.username,img:n.img,lastMessage:n.lastMessage}),e.jsx(p,{username:"janek",img:"https://source.unsplash.com/random",lastMessage:"brudka"}),e.jsx(p,{username:"janek",img:"https://source.unsplash.com/random",lastMessage:"brudka"}),e.jsx(p,{username:"janek",img:"https://source.unsplash.com/random",lastMessage:"brudka"}),e.jsx(p,{username:"janek",img:"https://source.unsplash.com/random",lastMessage:"brudka"}),e.jsx(p,{username:"janek",img:"https://source.unsplash.com/random",lastMessage:"brudka"})]})},Se="_container_16cuw_1",Ne="_wrapper_16cuw_5",Ce="_loadingScreen_16cuw_9",_={container:Se,wrapper:Ne,loadingScreen:Ce},Le=()=>{const{currentUser:a,isLoading:t}=l.useContext(v);return console.log(a),console.log(t),t?e.jsx("div",{className:_.loading,children:"Loading..."}):"email"in a?e.jsx("div",{className:_.container,children:e.jsxs("div",{className:_.wrapper,children:[e.jsx(be,{}),e.jsx(le,{})]})}):e.jsx(V,{to:{pathname:"/login"}})},$e="_container_rtgsm_1",Ue="_error_rtgsm_21",$={container:$e,error:Ue},Ee=()=>{const[a,t]=l.useState(""),n=w(),c=s=>{s.preventDefault();const r=s.currentTarget[0].value,o=s.currentTarget[1].value,i=s.currentTarget[2].value,m=s.currentTarget[4],b=m.files?m.files[0]:null;console.log(r);try{const d=F(x,o,i),M=K(je,r);if(b){const S=Z(M,b);S.on("state_changed",u=>{const T=u.bytesTransferred/u.totalBytes*100;switch(console.log("Upload is "+T+"% done"),u.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running");break}},u=>{t(String(u))},()=>{Y(S.snapshot.ref).then(async u=>{await G((await d).user,{displayName:r,photoURL:u}),await N(C(y,"users",(await d).user.uid),{uid:(await d).user.uid,displayName:r,email:o,photoURL:u}),await N(C(y,"userChats",(await d).user.uid),{})}),n("../",{replace:!0})})}}catch(d){t(String(d)),console.log(d)}};return e.jsxs("div",{className:$.container,children:[e.jsxs("form",{onSubmit:s=>c(s),children:[e.jsx("input",{type:"text",autoComplete:"username",placeholder:"Username"}),e.jsx("input",{type:"email",autoComplete:"email",placeholder:"E-mail"}),e.jsx("input",{type:"password",autoComplete:"new-password",placeholder:"Password"}),e.jsx("input",{type:"password",autoComplete:"new-password",placeholder:"Confirm password"}),e.jsx("input",{type:"file"}),e.jsx("button",{children:"Sign Up"}),a!==""&&e.jsx("span",{className:$.error,children:"Something went wrong"})]}),e.jsxs("p",{children:["Already have an account? ",e.jsx(E,{to:"/login",children:"Log In"})]})]})},Me="_container_11tcz_1",Te="_error_11tcz_25",U={container:Me,error:Te},ke=()=>{const[a,t]=l.useState(""),n=w(),c=s=>{s.preventDefault();const r=s.currentTarget[0].value,o=s.currentTarget[1].value;try{try{J(x,r,o),console.log("udalo sie zalogowac")}catch(i){t(String(i)),console.log(i)}n("../",{replace:!0}),console.log("przenosze na homepage")}catch(i){t(String(i)),console.log(i)}};return e.jsxs("div",{className:U.container,children:[e.jsxs("form",{onSubmit:s=>c(s),children:[e.jsx("input",{type:"email",autoComplete:"email",placeholder:"E-mail"}),e.jsx("input",{type:"password",autoComplete:"current-password",placeholder:"Password"}),e.jsx("button",{children:"Login"}),a!==""&&e.jsx("span",{className:U.error,children:"Something went wrong"})]}),e.jsxs("p",{children:["Don't have an account? ",e.jsx(E,{to:"/register",children:"Sign Up"})]})]})};function Ae(){return e.jsx("div",{className:se.container,children:e.jsxs(X,{children:[e.jsx(j,{path:"/",element:e.jsx(Le,{})}),e.jsx(j,{path:"/register",element:e.jsx(Ee,{})}),e.jsx(j,{path:"/login",element:e.jsx(ke,{})})]})})}A.createRoot(document.getElementById("root")).render(e.jsx(k.StrictMode,{children:e.jsx(ve,{children:e.jsx(Q,{children:e.jsx(Ae,{})})})}));
