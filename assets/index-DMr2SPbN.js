import{j as e,r as i,a as A}from"./react-BrP7bTIu.js";import{c as I}from"./react-dom-BtizlmEl.js";import{i as U,g as P,a as M,b as O,o as B,q as z,w as D,c as W,d as k,s as H,e as F,f as K,u as Y,h as Z,j as Q,k as N,l as b,m as G}from"./@firebase-DLhgF3GW.js";import"./firebase-BGoxOC5i.js";import{d as w,e as J,f as V,g as _}from"./react-router-C0nYgrbg.js";import{N as E,H as X}from"./react-router-dom-iW47g7mf.js";import"./scheduler-CzFDRTuY.js";import"./tslib-BGVaTf34.js";import"./idb-BXWtuYvb.js";import"./@remix-run-BgBg4VcQ.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))c(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&c(a)}).observe(document,{childList:!0,subtree:!0});function o(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(s){if(s.ep)return;s.ep=!0;const n=o(s);fetch(s.href,n)}})();const ee="_container_11yjs_2",se={container:ee},te="_container_ashy1_1",re={container:te},ne="_container_12177_1",oe="_time_12177_12",C={container:ne,time:oe},g=({messageText:r,time:t})=>e.jsxs("div",{className:C.container,children:[e.jsx("span",{children:r}),e.jsx("span",{className:C.time,children:t})]}),ae="_container_6gyfo_1",ce={container:ae},ie=()=>e.jsx("div",{className:ce.container,children:e.jsx("textarea",{})}),le=()=>e.jsxs("div",{className:re.container,children:[e.jsx(g,{messageText:"111111111111111111111111",time:"15:40"}),e.jsx(g,{messageText:"22222222222222222222",time:"15:40"}),e.jsx(g,{messageText:"333333333333333333333333333333333",time:"15:40"}),e.jsx(g,{messageText:"444444444444444444",time:"15:40"}),e.jsx(g,{messageText:"55555555555555555555555555",time:"15:40"}),e.jsx(ie,{})]}),de="_container_t6ds5_1",ue="_wrapper_t6ds5_14",pe="_username_t6ds5_20",me="_message_t6ds5_23",m={container:de,wrapper:ue,username:pe,message:me},ge={apiKey:"AIzaSyAB80-tZTx63iK-eSokF2n1HNM25fO_rZ4",authDomain:"react-chat-app-cf377.firebaseapp.com",projectId:"react-chat-app-cf377",storageBucket:"react-chat-app-cf377.appspot.com",messagingSenderId:"333727045415",appId:"1:333727045415:web:07aac7a056b70e402bbb02"};U(ge);const x=P(),he=M(),y=O(),j=i.createContext({currentUser:{},isLoading:!0}),xe=({children:r})=>{const[t,o]=i.useState({}),[c,s]=i.useState(!0);return i.useEffect(()=>{const n=B(x,a=>{a&&o(a),s(!1)});return()=>{n()}},[t]),e.jsx(j.Provider,{value:{currentUser:t,isLoading:c},children:r})},$=({chatUser:r,isSearched:t})=>{const{currentUser:o}=i.useContext(j),c=async()=>{if(o.uid!==""&&o.uid!==void 0){const s=o.uid>r.uid?o.uid+r.uid:r.uid+o.uid;console.log(s)}console.log(o.uid+r.uid)};return e.jsxs("div",{className:m.container,children:[e.jsx("img",{src:r.img}),t?e.jsx("div",{onClick:()=>c(),className:m.wrapper,children:e.jsx("p",{className:m.username,children:r.username})}):e.jsxs("div",{className:m.wrapper,children:[e.jsx("p",{className:m.username,children:r.username}),e.jsx("p",{className:m.message,children:r.lastMessage})]})]})},je="_container_17q7h_1",_e={container:je},fe=({setSearchedUser:r})=>{const[t,o]=i.useState(""),c=async s=>{const n=z(W(y,"users"),D("email","==",s));try{const a=await k(n);console.log(a.docs.length),a.docs.length>0?a.forEach(l=>{const u=l.data();console.log(u),r({username:u.displayName,img:u.photoURL,lastMessage:"???",uid:u.uid})}):r({username:"",img:"",lastMessage:"",uid:""})}catch(a){o(String(a)),console.log(a)}};return e.jsxs("div",{className:_e.container,children:[e.jsx("input",{type:"text",placeholder:"Search email",onChange:s=>{c(s.target.value)}}),t!==""&&e.jsx("p",{children:t})]})},ye="_container_yqqb2_1",we="_navbar_yqqb2_5",ve="_logoutBtn_yqqb2_11",f={container:ye,navbar:we,logoutBtn:ve},Se=()=>{const r=w(),{currentUser:t}=i.useContext(j),[o,c]=i.useState({username:"",img:"",lastMessage:"",uid:""}),[s]=i.useState({username:"temp",img:"https://source.unsplash.com/random",lastMessage:"jazda",uid:"qwertyuioQWERTYUIO"});return e.jsxs("div",{className:f.container,children:[e.jsxs("div",{className:f.navbar,children:[e.jsx("img",{src:t==null?void 0:t.photoURL,alt:t.displayName}),e.jsx("span",{children:t.displayName}),e.jsx("button",{className:f.logoutBtn,onClick:()=>{H(x).then(()=>{console.log("WYLogoWANO"),r("../login",{replace:!0})}).catch(n=>{console.log(n)})},children:"Logout"})]}),e.jsx(fe,{setSearchedUser:c}),o.username!==""&&e.jsx($,{chatUser:o,isSearched:!0}),e.jsx($,{chatUser:s})]})},Ne="_container_1a1q7_1",be="_wrapper_1a1q7_5",Ce="_loadingScreen_1a1q7_9",$e="_loader_1a1q7_18",Le="_rotation_1a1q7_1",h={container:Ne,wrapper:be,loadingScreen:Ce,loader:$e,rotation:Le},qe=()=>{const{currentUser:r,isLoading:t}=i.useContext(j);return console.log(r),console.log(t),t?e.jsx("div",{className:h.loadingScreen,children:e.jsx("span",{className:h.loader})}):"email"in r?e.jsx("div",{className:h.container,children:e.jsxs("div",{className:h.wrapper,children:[e.jsx(Se,{}),e.jsx(le,{})]})}):e.jsx(J,{to:{pathname:"/login"}})},Ee="_container_rtgsm_1",Te="_error_rtgsm_21",L={container:Ee,error:Te},Re=()=>{const[r,t]=i.useState(""),o=w(),c=s=>{s.preventDefault();const n=s.currentTarget[0].value,a=s.currentTarget[1].value,l=s.currentTarget[2].value,u=s.currentTarget[4],v=u.files?u.files[0]:null;console.log(n);try{const p=F(x,a,l),T=K(he,n);if(v){const S=Y(T,v);S.on("state_changed",d=>{const R=d.bytesTransferred/d.totalBytes*100;switch(console.log("Upload is "+R+"% done"),d.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running");break}},d=>{t(String(d))},()=>{Z(S.snapshot.ref).then(async d=>{await Q((await p).user,{displayName:n,photoURL:d}),await N(b(y,"users",(await p).user.uid),{uid:(await p).user.uid,displayName:n,email:a,photoURL:d}),await N(b(y,"userChats",(await p).user.uid),{})}),o("../",{replace:!0})})}}catch(p){t(String(p)),console.log(p)}};return e.jsxs("div",{className:L.container,children:[e.jsxs("form",{onSubmit:s=>c(s),children:[e.jsx("input",{type:"text",autoComplete:"username",placeholder:"Username"}),e.jsx("input",{type:"email",autoComplete:"email",placeholder:"E-mail"}),e.jsx("input",{type:"password",autoComplete:"new-password",placeholder:"Password"}),e.jsx("input",{type:"password",autoComplete:"new-password",placeholder:"Confirm password"}),e.jsx("input",{type:"file"}),e.jsx("button",{children:"Sign Up"}),r!==""&&e.jsx("span",{className:L.error,children:"Something went wrong"})]}),e.jsxs("p",{children:["Already have an account? ",e.jsx(E,{to:"/login",children:"Log In"})]})]})},Ae="_container_zdrll_1",Ie="_error_zdrll_38",q={container:Ae,error:Ie},Ue=()=>{const[r,t]=i.useState(""),o=w(),c=s=>{s.preventDefault();const n=s.currentTarget[0].value,a=s.currentTarget[1].value;try{try{G(x,n,a),console.log("udalo sie zalogowac")}catch(l){t(String(l)),console.log(l)}o("../",{replace:!0}),console.log("przenosze na homepage")}catch(l){t(String(l)),console.log(l)}};return e.jsxs("div",{className:q.container,children:[e.jsxs("form",{onSubmit:s=>c(s),children:[e.jsx("input",{type:"email",autoComplete:"email",placeholder:"E-mail"}),e.jsx("input",{type:"password",autoComplete:"current-password",placeholder:"Password"}),e.jsx("button",{children:"Login"}),r!==""&&e.jsx("span",{className:q.error,children:"Something went wrong"})]}),e.jsxs("p",{children:["Don't have an account? ",e.jsx(E,{to:"/register",children:"Sign Up"})]})]})};function Pe(){return e.jsx("div",{className:se.container,children:e.jsxs(V,{children:[e.jsx(_,{path:"/",element:e.jsx(qe,{})}),e.jsx(_,{path:"/register",element:e.jsx(Re,{})}),e.jsx(_,{path:"/login",element:e.jsx(Ue,{})})]})})}I.createRoot(document.getElementById("root")).render(e.jsx(A.StrictMode,{children:e.jsx(xe,{children:e.jsx(X,{children:e.jsx(Pe,{})})})}));
